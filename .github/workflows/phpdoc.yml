name: Generar documentación PHP

on:
  push:
    branches:
      - main

jobs:
  phpdoc:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ Clonar el repositorio
      - name: Clonar repositorio
        uses: actions/checkout@v3

      # 2️⃣ Configurar PHP
      - name: Configurar PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.1'

      # 3️⃣ Instalar Composer
      - name: Instalar Composer
        run: sudo apt update && sudo apt install -y composer

      # 4️⃣ Instalar PHPDocumentor localmente
      - name: Instalar PHPDocumentor
        run: composer require --dev phpdocumentor/phpdocumentor

      # 5️⃣ Generar documentación
      - name: Generar documentación PHP
        run: |
          vendor/bin/phpdoc -d php/ -t docs/phpdocs/
      
      # 6️⃣ Subir la documentación generada como artifact
      - name: Guardar documentación generada
        uses: actions/upload-artifact@v3
        with:
          name: phpdocs
          path: docs/phpdocs/
